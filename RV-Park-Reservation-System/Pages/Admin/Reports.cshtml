@page
@model RV_Park_Reservation_System.Pages.Admin.ReportsModel
@{
    ViewData["Title"] = "Reports";
}

<div class="container">
    <h1 class="display-4 text-center text-primary my-5">Reports</h1>

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="current-reservations-tab" data-bs-toggle="tab" data-bs-target="#current-reservations" type="button" role="tab" aria-controls="current-reservations" aria-selected="true">Current Reservations</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="current-availability-tab" data-bs-toggle="tab" data-bs-target="#current-availability" type="button" role="tab" aria-controls="current-availability" aria-selected="false">Availability</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="tomorrow-activity-tab" data-bs-toggle="tab" data-bs-target="#tomorrow-activity" type="button" role="tab" aria-controls="tomorrow-activity" aria-selected="false">Tomorrow's Activity</button>
        </li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
        <div class="tab-pane active" id="current-reservations" role="tabpanel" aria-labelledby="current-reservations-tab">
            <div class="border backgroundWhite container p-3">
                <div class="row">
                    <div class="col-12 text-right">                       
                        <button class=" btn btn-primary" onclick="convertPDF('Reservations','content1');"><i class="fas fa-file-export"></i>&nbsp;Export PDF</button>                                                   
                    </div>
                </div>
                <br />
                <br />
                <div id="content1">                    
                    <table id="DTsiteCat" class="table table-striped table-bordered mx-0 w-100">
                        <thead>
                            <tr>
                                <th>
                                    Name
                                </th>
                                <th>
                                    Description
                                </th>
                                <th>
                                    Location ID
                                </th>                               
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <div class="tab-pane" id="current-availability" role="tabpanel" aria-labelledby="current-availability-tab">
            <div class="border backgroundWhite container p-3">
                <div class="row">
                    <div class="col-12 text-right">
                        <button class=" btn btn-primary" onclick="convertPDF('Availability','content2');"><i class="fas fa-file-export"></i>&nbsp;Export PDF</button>
                    </div>
                </div>
                <br />
                <br />
                <div id="content2">
                    <table id="DTsiteRate" class="table table-striped table-bordered mx-0 w-100">
                        <thead>
                            <tr>
                                <th>
                                    Rate Amount
                                </th>
                                <th>
                                    Start Date
                                </th>
                                <th>
                                    End Date
                                </th>
                                <th>
                                    Site Category ID
                                </th>                                
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <div class="tab-pane" id="tomorrow-activity" role="tabpanel" aria-labelledby="tomorrow-activity-tab">
            <div class="border backgroundWhite container p-3">
                <div class="row">
                    <div class="col-12 text-right">
                        <button class=" btn btn-primary" onclick="convertPDF('Activity','content3');"><i class="fas fa-file-export"></i>&nbsp;Export PDF</button>
                    </div>
                </div>
                <br />
                <br />
                <div id="content3">
                    <table id="DTspecEvent" class="table table-striped table-bordered mx-0 w-100">
                        <thead>
                            <tr>
                                <th>
                                    Name
                                </th>
                                <th>
                                    Start Date
                                </th>
                                <th>
                                    End Date
                                </th>
                                <th>
                                    Description
                                </th>                             
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script src="~/js/reports.js"></script>
    <script>
    var triggerTabList = [].slice.call(document.querySelectorAll('#myTab a'))
    triggerTabList.forEach(function (triggerEl) {
        var tabTrigger = new bootstrap.Tab(triggerEl)

        triggerEl.addEventListener('click', function (event) {
            event.preventDefault()
            tabTrigger.show()
        })
    })
    </script>


    <script>

        function convertPDF(fileName, elementID) {           
            window.jsPDF = window.jspdf.jsPDF;
            window.html2canvas = html2canvas;            
            var doc = new jsPDF('p', 'pt', 'letter');

            var title = fileName;
            doc.setFontSize(1)

            var elementHTML = $('#' + elementID).html();
            var specialElementHandlers = {
                '#excludeFromTextExtraction': function (element, renderer) {
                    return true;
                }               
            };

            doc.html(elementHTML, {
                margin: [5, 5, 5, 5],
                'x': 15,
                'y': 15,
                'elementHandlers': specialElementHandlers
            });

            setTimeout(function() {
                doc.save(title+'.pdf');
            }, 1000);

        }

    </script>


}